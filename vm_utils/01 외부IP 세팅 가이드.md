1) STATIC IP 생성
```bash
# 변수
REGION="asia-northeast3"
STATIC_NAME="crypto-fluxor-ip"

# 1) 예약(생성)
gcloud compute addresses create "$STATIC_NAME" --region="$REGION"

# 2) 확인(실제 IP 얻기)
gcloud compute addresses describe "$STATIC_NAME" \
  --region="$REGION" --format="get(address)"

# 3) 사용 중인 IP 리스트 확인
gcloud compute addresses list
```
⸻

2) VM 생성 (외부 IP 없이)
```bash
ZONE="asia-northeast3-c"
VM="crypto-fluxor-vm"

gcloud compute instances create "$VM" \
  --zone="$ZONE" \
  --machine-type=e2-micro \
  --image-family=debian-12 \
  --image-project=debian-cloud \
  --no-address
```

⸻

3) STATIC IP 붙이기
```bash
# STATIC_NAME으로 실제 주소 조회
STATIC_IP=$(gcloud compute addresses describe "$STATIC_NAME" \
  --region="$REGION" --format="value(address)")

# VM NIC(nic0)에 Access Config 추가(외부 IP 부여)
gcloud compute instances add-access-config "$VM" \
  --zone="$ZONE" \
  --network-interface=nic0 \
  --access-config-name="External NAT" \
  --address="$STATIC_IP"

# 확인
gcloud compute instances describe "$VM" \
  --zone="$ZONE" \
  --format='get(networkInterfaces[0].accessConfigs[0].natIP)'
```
참고: 이미 외부 IP가 붙어 있다면 add-access-config 대신 교체를 사용하세요.
```bash
gcloud compute instances update-access-config "$VM" \
  --zone="$ZONE" \
  --network-interface=nic0 \
  --access-config-name="External NAT" \
  --nat-ip="$STATIC_IP"
```
⸻

4) STATIC IP 떼어내기
```bash
gcloud compute instances delete-access-config "$VM" \
  --zone="$ZONE" \
  --network-interface=nic0 \
  --access-config-name="External NAT"
```
팁
	•	Access Config 이름은 기본적으로 “External NAT” 입니다(대소문자/공백 포함).
	•	한 NIC에는 Access Config가 최대 1개만 가능합니다. (붙이기 전에 있으면 교체 명령 사용)
	•	이렇게 하면 필요할 때만 in-use 과금, 그 외에는 RESERVED(unused) 요금으로 떨어져 비용을 줄일 수 있습니다.


